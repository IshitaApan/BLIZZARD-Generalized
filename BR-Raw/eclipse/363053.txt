[CSS] CSS engine ignores alternative element providers

I started to investigate what would be necessary to hook in a custom element provider. Although I can see my custom provider is picked up by CSSEngineImpl, it's never actually used. Tracing through AbstractCSSEngine#getElement(Object) lines 844 - 849 seems incorrect: 		if (element instanceof Element) 			elt = (Element) element; 		else if (elementProvider != null) { 			elt = elementProvider.getElement(element, this); 		} else if (elementProvider == null) { 			Object tmp = widgetsMap.get(element.getClass().getName()); 			if (tmp == null) { 				Class parent = element.getClass(); 				do { 					parent = parent.getSuperclass(); 					tmp = widgetsMap.get(parent.getName()); 				} while (tmp == null && parent != Object.class); 			} 			//found && parentClass != ElementAdapter.class // line 844 			elementProvider = (IElementProvider) tmp; // PROBLEM 			// Looks like this can be NULL see bug 338756 			if( elementProvider != null ) { 				elt = elementProvider.getElement(element, this);	 			} 		} This code causes the first matching element provider found to become *the* only element provider consulted. I think it should instead be: 			if(tmp != null && tmp instanceof IElementProvider) { 				elt = ((IElementProvider)tmp).getElement(element, this); 			} This has the expected effect.