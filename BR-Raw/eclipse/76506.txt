[Preferences] UIPreferenceInitializer aggressively accesses instance preferences

build i1013 - The UIPreferenceInitializer class sets the default preferences for the UI plug-in. - It accesses the default scope via the UI preference class ScopedPreferenceStore. - during the initialization of this class instance, the instance scope is accessed. This is problematic for RCP applications where the UI plug-in is initialized but the instance location has not yet been set. See bug 75397 comment #3, point #1. Plug-ins which are a part of the RCP should be able to run with no instance location. code should look like: // TODO: use a constant for this plug-in id IEclipsePreferences node = new DefaultScope().getNode("org.eclipse.ui"); node.put(IWorkbenchPreferenceConstants.OPEN_NEW_PERSPECTIVE, IWorkbenchPreferenceConstants.OPEN_PERSPECTIVE_REPLACE); //Deprecated but kept for backwards compatibility node.put(IWorkbenchPreferenceConstants.PROJECT_OPEN_NEW_PERSPECTIVE, IWorkbenchPreferenceConstants.OPEN_PERSPECTIVE_REPLACE); node.put(IWorkbenchPreferenceConstants.SHIFT_OPEN_NEW_PERSPECTIVE, IWorkbenchPreferenceConstants.OPEN_PERSPECTIVE_REPLACE); node.put(IWorkbenchPreferenceConstants.ALTERNATE_OPEN_NEW_PERSPECTIVE, IWorkbenchPreferenceConstants.OPEN_PERSPECTIVE_REPLACE); // Although there is no longer any item on the preference pages // for setting the linking preference, since it is now a per-part setting, // it remains as a preference to allow product overrides of the // initial state of linking in the Navigator. // By default, linking is off. node.putBoolean(IWorkbenchPreferenceConstants.LINK_NAVIGATOR_TO_EDITOR, false); // Appearance / Presentation preferences node.put(IWorkbenchPreferenceConstants.PRESENTATION_FACTORY_ID, "org.eclipse.ui.presentations.default"); //$NON-NLS-1$ node.putBoolean(IWorkbenchPreferenceConstants.SHOW_TRADITIONAL_STYLE_TABS, true); node.putBoolean(IWorkbenchPreferenceConstants.ENABLE_ANIMATIONS, true); node.put(IWorkbenchPreferenceConstants.DOCK_PERSPECTIVE_BAR, IWorkbenchPreferenceConstants.TOP_LEFT); node.putBoolean(IWorkbenchPreferenceConstants.SHOW_TEXT_ON_PERSPECTIVE_BAR, true); // the fast view bar should be on the bottom of a fresh workspace node.put(IWorkbenchPreferenceConstants.INITIAL_FAST_VIEW_BAR_LOCATION, IWorkbenchPreferenceConstants.BOTTOM); // default to showing intro on startup node.putBoolean(IWorkbenchPreferenceConstants.SHOW_INTRO, true); // Default to the standard key configuration. node.put(IWorkbenchPreferenceConstants.KEY_CONFIGURATION_ID, "org.eclipse.ui.defaultAcceleratorConfiguration"); //$NON-NLS-1$ // The default character width is undefined (i.e., -1) node.putInt(IWorkbenchPreferenceConstants.EDITOR_MINIMUM_CHARACTERS, -1); // Set the workspace selection dialog to open by default node.putBoolean(IWorkbenchPreferenceConstants.SHOW_WORKSPACE_SELECTION_DIALOG, true); // TODO: cannot add the listener unless the instance location is set // store.addPropertyChangeListener(new PlatformUIPreferenceListener());