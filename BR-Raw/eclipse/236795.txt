[JFace] SWT Exception creates endless cycle

Build ID: Build id: I20080530-1730 When an unexpected condition occurs, it is possible for the code handling the event to trigger follow on logged events, causing a cycle of events to flood the log. Steps To Reproduce: In my case it is very hard to reproduce consistently, because it appears to happen in the case where network connectivity is lost during the middle of a p2 refresh. (Happens all too frequently with my network connection!) For a better case see bug 234997. Stack trace follows. This is an issue that appears to implicate both p2 and ui but p2 folks see it as not a P2 issue. From initial inspection it might be caused or preventable by checking particulars of the events on the ui client side, but OTOH, it seems that UI should prevent this sort of thing from happening. Also, I have seen similar issues in non-p2 usages but none of them clearly repeatable. Certainly API users have a responsibility to take care in triggering There has to be a gatekeeper somewhere to prevent this from happening. I almost want to mark this as critical as while the trigger is rare the consequences are quite serious. It manages the impressive feat of taking OS X to its knees, sometimes forcing a hard reboot. Following the hard reboot, the console can be so flooded that the system still crawls while I attempt to manually kill writing to syslog. Personally I feel that this is something that has to be fixed prior to final 3.4. [below repeats endlessly at millis intervals] Unhandled event loop exception during blocked modal context. org.eclipse.swt.SWTException: Widget is disposed at org.eclipse.swt.SWT.error(SWT.java:3775) at org.eclipse.swt.SWT.error(SWT.java:3693) at org.eclipse.swt.SWT.error(SWT.java:3664) at org.eclipse.swt.widgets.Display.error(Display.java:1124) at org.eclipse.swt.widgets.Display.checkDevice(Display.java:624) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3035) at org.eclipse.jface.operation.ModalContext$ModalContextThread.block(ModalContext.java:172) at org.eclipse.jface.operation.ModalContext.run(ModalContext.java:370) at org.eclipse.jface.dialogs.ProgressMonitorDialog.run(ProgressMonitorDialog.java:507) at org.eclipse.equinox.internal.provisional.p2.ui.actions.ProfileModificationAction.getProvisioningPlan(ProfileModificationAction.java:68) at org.eclipse.equinox.internal.provisional.p2.ui.actions.ProfileModificationAction.run(ProfileModificationAction.java:78) at org.eclipse.jface.action.Action.runWithEvent(Action.java:498) at org.eclipse.equinox.internal.p2.ui.sdk.UpdateAndInstallDialog.verticalButtonPressed(UpdateAndInstallDialog.java:732) at org.eclipse.equinox.internal.p2.ui.sdk.UpdateAndInstallDialog$21.handleEvent(UpdateAndInstallDialog.java:715) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1557) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1581) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1566) at org.eclipse.swt.widgets.Widget.notifyListeners(Widget.java:1357) at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:3471) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3061) at org.eclipse.jface.window.Window.runEventLoop(Window.java:825) at org.eclipse.jface.window.Window.open(Window.java:801) at org.eclipse.equinox.internal.p2.ui.sdk.UpdateHandler.openDialog(UpdateHandler.java:55) at org.eclipse.equinox.internal.p2.ui.sdk.UpdateHandler.execute(UpdateHandler.java:46) at org.eclipse.ui.internal.handlers.HandlerProxy.execute(HandlerProxy.java:281) at org.eclipse.core.commands.Command.executeWithChecks(Command.java:476) at org.eclipse.core.commands.ParameterizedCommand.executeWithChecks(ParameterizedCommand.java:508) at org.eclipse.ui.internal.handlers.HandlerService.executeCommand(HandlerService.java:169) at org.eclipse.ui.internal.handlers.SlaveHandlerService.executeCommand(SlaveHandlerService.java:247) at org.eclipse.ui.menus.CommandContributionItem.handleWidgetSelection(CommandContributionItem.java:619) at org.eclipse.ui.menus.CommandContributionItem.access$10(CommandContributionItem.java:605) at org.eclipse.ui.menus.CommandContributionItem$4.handleEvent(CommandContributionItem.java:595) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1557) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1581) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1566) at org.eclipse.swt.widgets.Widget.notifyListeners(Widget.java:1357) at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:3471) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3061) at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2382) at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2346) at org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2198) at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:493) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:288) at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:488) at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149) at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:112) at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:193) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:382) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) at java.lang.reflect.Method.invoke(Method.java:585) at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:549) at org.eclipse.equinox.launcher.Main.basicRun(Main.java:504) at org.eclipse.equinox.launcher.Main.run(Main.java:1236)