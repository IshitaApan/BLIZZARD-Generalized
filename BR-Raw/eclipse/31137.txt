migrating from 2.0 to 2.1 with auto-build off causes UI glitch

Build 20030206 Migrating from 2.0 to 2.1 with auto-build off causes UI glitch Steps to reproduce: 1 - Open a fresh new workspace with 2.0.2 2 - Turn the auto-build preference off. 3 - Create a new Java project with a Java source-file (.class will not be generated) 3 - Exit workspace. Core workspace description file (.workspace) will reflect the change 4 - Open the same workspace with 20030206 5 - Auto-build is off - if you change the Java source file, no .class will be automatically generated Also, he UI shows correctly the Build button in the tool bar and the "Build project" and "Build all" menu items under the Project menu. 6 - Turn the auto-build preference on 7 - Now there are *two* "Build all" buttons in the tool bar, and the "Build All" and "Build Project" are still available (which is a bug). But if you change the Java source file and save it, a .class will automatically be generated. I could also notice that if you repeat the turn off/turn on operations for the Auto-build preference, you can end up with two "Build All" and "Build Project" items under the Project menu. When the workspace starts, if there is an old workspace description file, it is read, its values are set on the preference store, and the file is discarded. Since Workspace starts before Workbench, and Workbench auto-build preference value will be true (by default), Workbench cannot rely only on PropertyChangeEvents to synchronize its own auto-build preference with Workspace's. It looks like it should be forced to be equal to whatever Workspace preference value is at some point before changes are made. Another bug related to this new feature is: bug 28154.