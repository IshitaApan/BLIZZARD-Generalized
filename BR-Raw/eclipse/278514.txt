[WorkbenchParts] NPE in PageBookView.containsPart

copied from bug 267425 comment 46: I have found a problem (probably related to latest changes in partHidden() code): 3.5 RC2 throws a NPE in this case: 1) Close all perspectives 2) Open perspective 1 without Properties view 3) Open perspective 2 with Properties view 4) Open Bug Explorer 5) Select a bug there 6) Properties view shows bug properties 7) Switch back to perspective 1 8) KABOOM: java.lang.NullPointerException at org.eclipse.ui.part.PageBookView.containsPart(PageBookView.java:1076) at org.eclipse.ui.part.PageBookView.partHidden(PageBookView.java:1062) at org.eclipse.ui.views.properties.PropertySheet.partHidden(PropertySheet.java:283) at org.eclipse.ui.part.PageBookView$4.partHidden(PageBookView.java:1027) at org.eclipse.ui.internal.PartListenerList2$6.run(PartListenerList2.java:151) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) at org.eclipse.core.runtime.Platform.run(Platform.java:888) at org.eclipse.ui.internal.PartListenerList2.fireEvent(PartListenerList2.java:55) at org.eclipse.ui.internal.PartListenerList2.firePartHidden(PartListenerList2.java:149) at org.eclipse.ui.internal.PartService.firePartHidden(PartService.java:259) at org.eclipse.ui.internal.WorkbenchPagePartList.firePartHidden(WorkbenchPagePartList.java:64) at org.eclipse.ui.internal.PartList.partHidden(PartList.java:207) at org.eclipse.ui.internal.PartList.access$3(PartList.java:198) at org.eclipse.ui.internal.PartList$1.propertyChanged(PartList.java:49) at org.eclipse.ui.internal.WorkbenchPartReference.fireInternalPropertyChange(WorkbenchPartReference.java:375) at org.eclipse.ui.internal.WorkbenchPartReference.fireVisibilityChange(WorkbenchPartReference.java:536) at org.eclipse.ui.internal.PartPane.setVisible(PartPane.java:318) at org.eclipse.ui.internal.ViewPane.setVisible(ViewPane.java:529) at org.eclipse.ui.internal.presentations.PresentablePart.setVisible(PresentablePart.java:180) at de.loskutov.eclipseskins.presentation.VSStackPresentation.selectPart(VSStackPresentation.java:762) at org.eclipse.ui.internal.PartStack.refreshPresentationSelection(PartStack.java:1256) at org.eclipse.ui.internal.PartStack.setSelection(PartStack.java:1209) at org.eclipse.ui.internal.PerspectiveHelper.bringPartToTop(PerspectiveHelper.java:444) at org.eclipse.ui.internal.Perspective.bringToTop(Perspective.java:228) at org.eclipse.ui.internal.WorkbenchPage.internalBringToTop(WorkbenchPage.java:796) at org.eclipse.ui.internal.WorkbenchPage.activate(WorkbenchPage.java:613) at org.eclipse.ui.internal.WorkbenchPage.busyShowView(WorkbenchPage.java:1092) at org.eclipse.ui.internal.WorkbenchPage.busyShowView(WorkbenchPage.java:1069) at org.eclipse.ui.internal.WorkbenchPage$20.run(WorkbenchPage.java:3816) at org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:70) at org.eclipse.ui.internal.WorkbenchPage.showView(WorkbenchPage.java:3813) at org.eclipse.ui.internal.WorkbenchPage.showView(WorkbenchPage.java:3789) at org.eclipse.ui.statushandlers.WorkbenchStatusDialogManager$7.widgetSelected(WorkbenchStatusDialogManager.java:1507) at org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:228) To reproduce, please install last stable FindBugs plugin.