[Compatibility] Global selection in evaluation context is no longer a java.util.Collection

From http://wiki.eclipse.org/Command_Core_Expressions: ---------------------------------------------------- The IEvaluationContext provides a default variable for evaluations, and a number of named variables. In the command framework, we provide the global selection as a java.util.Collection as the default variable. It can either be empty, have one entry (if the ISelection was something like an ITextSelection), or have the contents of an IStructuredSelection. ---------------------------------------------------- Our product has based some property testers and expressions on the stated fact that the global selection provided by the evaluation context is an instance of java.util.Collection (the property tester's "type" attribute is java.util.Collection). This seems to have changed in 4.2, as I am currently seeing an instance of org.eclipse.jface.viewers.TreeSelection instead. As a result, our expressions are not being evaluated. This raises a few questions: * Is this considered API? I could only find mention of it at the above-listed wiki page, where it was mentioned only in passing. Perhaps this was simply a hint about an implementation detail. * Is there a way to change the type and evaluation of our property testers such that they will be able to work regardless of whether the evaluation context provides a Collection or a TreeSelection (the contained objects as a whole are interesting for the evaluation, not the type of the container). Perhaps we can use "adapt" in our expressions?