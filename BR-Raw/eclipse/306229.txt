[Compatibility] NPE thrown when spawning another console

Hit this when looking over bug 304863. org.eclipse.e4.core.services.internal.context.InjectionException: Unexpected error invoking method "setPart" 	at org.eclipse.e4.core.services.internal.context.InjectionMethod.invoke(InjectionMethod.java:66) 	at org.eclipse.e4.core.services.internal.context.InjectionMethod.notify(InjectionMethod.java:44) 	at org.eclipse.e4.core.services.internal.context.EclipseContext$TrackableComputationExt.notify(EclipseContext.java:175) 	at org.eclipse.e4.core.services.internal.context.EclipseContext.processScheduled(EclipseContext.java:461) 	at org.eclipse.e4.core.services.internal.context.EclipseContext.set(EclipseContext.java:483) 	at org.eclipse.e4.workbench.ui.internal.PartServiceImpl.activate(PartServiceImpl.java:320) 	at org.eclipse.e4.workbench.ui.internal.PartServiceImpl.showExistingPart(PartServiceImpl.java:458) 	at org.eclipse.e4.workbench.ui.internal.PartServiceImpl.showPart(PartServiceImpl.java:526) 	at org.eclipse.ui.internal.WorkbenchPage.busyShowView(WorkbenchPage.java:522) 	at org.eclipse.ui.internal.WorkbenchPage$6.run(WorkbenchPage.java:2098) 	at org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:70) 	at org.eclipse.ui.internal.WorkbenchPage.showView(WorkbenchPage.java:2095) 	at org.eclipse.ui.internal.console.ConsoleViewConsoleFactory.openConsole(ConsoleViewConsoleFactory.java:37) 	at org.eclipse.ui.internal.console.OpenConsoleAction$ConsoleFactoryAction.run(OpenConsoleAction.java:140) 	at org.eclipse.ui.internal.console.OpenConsoleAction$ConsoleFactoryAction.runWithEvent(OpenConsoleAction.java:150) 	at org.eclipse.jface.action.ActionContributionItem.handleWidgetSelection(ActionContributionItem.java:584) 	at org.eclipse.jface.action.ActionContributionItem.access$2(ActionContributionItem.java:501) 	at org.eclipse.jface.action.ActionContributionItem$5.handleEvent(ActionContributionItem.java:411) 	at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) 	at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1050) 	at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:4037) 	at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3628) 	at org.eclipse.e4.ui.workbench.swt.internal.PartRenderingEngine$5.run(PartRenderingEngine.java:553) 	at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) 	at org.eclipse.e4.ui.workbench.swt.internal.PartRenderingEngine.run(PartRenderingEngine.java:473) 	at org.eclipse.e4.workbench.ui.internal.E4Workbench.createAndRunUI(E4Workbench.java:100) 	at org.eclipse.ui.internal.Workbench$3.run(Workbench.java:527) 	at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) 	at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:513) 	at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149) 	at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:115) 	at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196) 	at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110) 	at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79) 	at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:369) 	at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179) 	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) 	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:48) 	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37) 	at java.lang.reflect.Method.invoke(Method.java:600) 	at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:619) 	at org.eclipse.equinox.launcher.Main.basicRun(Main.java:574) 	at org.eclipse.equinox.launcher.Main.run(Main.java:1406) 	at org.eclipse.equinox.launcher.Main.main(Main.java:1382) Caused by: java.lang.reflect.InvocationTargetException 	at sun.reflect.GeneratedMethodAccessor10.invoke(Unknown Source) 	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37) 	at java.lang.reflect.Method.invoke(Method.java:600) 	at org.eclipse.e4.core.services.internal.context.InjectionMethod.callMethod(InjectionMethod.java:102) 	at org.eclipse.e4.core.services.internal.context.InjectionMethod.invoke(InjectionMethod.java:63) 	... 43 more Caused by: java.lang.NullPointerException 	at org.eclipse.ui.internal.contexts.ContextService.deactivateContext(ContextService.java:147) 	at org.eclipse.ui.internal.console.ConsoleView.partDeactivated(ConsoleView.java:693) 	at org.eclipse.ui.internal.WorkbenchPage.firePartDeactivated(WorkbenchPage.java:2481) 	at org.eclipse.ui.internal.WorkbenchPage.access$6(WorkbenchPage.java:2470) 	at org.eclipse.ui.internal.WorkbenchPage$E4PartListener.partDeactivated(WorkbenchPage.java:125) 	at org.eclipse.e4.workbench.ui.internal.PartServiceImpl.firePartDeactivated(PartServiceImpl.java:177) 	at org.eclipse.e4.workbench.ui.internal.PartServiceImpl.setPart(PartServiceImpl.java:125) 	... 48 more