[Workbench] Dangerous use of getActiveShell in the workbench

