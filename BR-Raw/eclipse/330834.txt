[Compatibility] IPageListeners are not being notified when a workbench page is closed

1. Open a text file. 2. Window > Close Perspective 3. The 'Back' tool item is still enabled. Click on it. You'll get some error dialogs. java.lang.NullPointerException 	at org.eclipse.ui.internal.Workbench.setReference(Workbench.java:1680) 	at org.eclipse.ui.internal.Workbench.access$18(Workbench.java:1669) 	at org.eclipse.ui.internal.Workbench$30.handleEvent(Workbench.java:1620) 	at org.eclipse.e4.ui.services.internal.events.UIEventHandler.handleEvent(UIEventHandler.java:41) 	at org.eclipse.equinox.internal.event.EventHandlerWrapper.handleEvent(EventHandlerWrapper.java:197) 	at org.eclipse.equinox.internal.event.EventHandlerTracker.dispatchEvent(EventHandlerTracker.java:197) 	at org.eclipse.equinox.internal.event.EventHandlerTracker.dispatchEvent(EventHandlerTracker.java:1) 	at org.eclipse.osgi.framework.eventmgr.EventManager.dispatchEvent(EventManager.java:230) 	at org.eclipse.osgi.framework.eventmgr.ListenerQueue.dispatchEventSynchronous(ListenerQueue.java:148) 	at org.eclipse.equinox.internal.event.EventAdminImpl.dispatchEvent(EventAdminImpl.java:135) 	at org.eclipse.equinox.internal.event.EventAdminImpl.sendEvent(EventAdminImpl.java:78) 	at org.eclipse.equinox.internal.event.EventComponent.sendEvent(EventComponent.java:39) 	at org.eclipse.e4.ui.services.internal.events.EventBroker.send(EventBroker.java:73) 	at org.eclipse.e4.ui.internal.workbench.UIEventPublisher.notifyChanged(UIEventPublisher.java:58) 	at org.eclipse.emf.common.notify.impl.BasicNotifierImpl.eNotify(BasicNotifierImpl.java:380) 	at org.eclipse.e4.ui.model.application.ui.basic.impl.PartImpl.setContext(PartImpl.java:528) 	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.createGui(PartRenderingEngine.java:457) 	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.createGui(PartRenderingEngine.java:554) 	at org.eclipse.e4.ui.workbench.renderers.swt.StackRenderer.showTab(StackRenderer.java:516) 	at org.eclipse.e4.ui.workbench.renderers.swt.LazyStackRenderer$1.handleEvent(LazyStackRenderer.java:74) 	at org.eclipse.e4.ui.services.internal.events.UIEventHandler.handleEvent(UIEventHandler.java:41) 	at org.eclipse.equinox.internal.event.EventHandlerWrapper.handleEvent(EventHandlerWrapper.java:197) 	at org.eclipse.equinox.internal.event.EventHandlerTracker.dispatchEvent(EventHandlerTracker.java:197) 	at org.eclipse.equinox.internal.event.EventHandlerTracker.dispatchEvent(EventHandlerTracker.java:1) 	at org.eclipse.osgi.framework.eventmgr.EventManager.dispatchEvent(EventManager.java:230) 	at org.eclipse.osgi.framework.eventmgr.ListenerQueue.dispatchEventSynchronous(ListenerQueue.java:148) 	at org.eclipse.equinox.internal.event.EventAdminImpl.dispatchEvent(EventAdminImpl.java:135) 	at org.eclipse.equinox.internal.event.EventAdminImpl.sendEvent(EventAdminImpl.java:78) 	at org.eclipse.equinox.internal.event.EventComponent.sendEvent(EventComponent.java:39) 	at org.eclipse.e4.ui.services.internal.events.EventBroker.send(EventBroker.java:73) 	at org.eclipse.e4.ui.internal.workbench.UIEventPublisher.notifyChanged(UIEventPublisher.java:58) 	at org.eclipse.emf.common.notify.impl.BasicNotifierImpl.eNotify(BasicNotifierImpl.java:380) 	at org.eclipse.e4.ui.model.application.ui.impl.ElementContainerImpl.setSelectedElement(ElementContainerImpl.java:171) 	at org.eclipse.e4.ui.internal.workbench.ModelServiceImpl.showElementInWindow(ModelServiceImpl.java:259) 	at org.eclipse.e4.ui.internal.workbench.ModelServiceImpl.bringToTop(ModelServiceImpl.java:227) 	at org.eclipse.e4.ui.internal.workbench.PartServiceImpl.activate(PartServiceImpl.java:485) 	at org.eclipse.e4.ui.internal.workbench.PartServiceImpl.activate(PartServiceImpl.java:460) 	at org.eclipse.e4.ui.internal.workbench.PartServiceImpl.activate(PartServiceImpl.java:449) 	at org.eclipse.e4.ui.internal.workbench.PartServiceImpl.showPart(PartServiceImpl.java:848) 	at org.eclipse.ui.internal.WorkbenchPage.busyOpenEditor(WorkbenchPage.java:2259) 	at org.eclipse.ui.internal.WorkbenchPage.access$14(WorkbenchPage.java:2221) 	at org.eclipse.ui.internal.WorkbenchPage$6.run(WorkbenchPage.java:2203) 	at org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:70) 	at org.eclipse.ui.internal.WorkbenchPage.openEditor(WorkbenchPage.java:2199) 	at org.eclipse.ui.internal.WorkbenchPage.openEditor(WorkbenchPage.java:2183) 	at org.eclipse.ui.internal.WorkbenchPage.openEditor(WorkbenchPage.java:2174) 	at org.eclipse.ui.internal.NavigationHistoryEntry.restoreLocation(NavigationHistoryEntry.java:66) 	at org.eclipse.ui.internal.NavigationHistory.gotoEntry(NavigationHistory.java:452) 	at org.eclipse.ui.internal.NavigationHistory.shiftEntry(NavigationHistory.java:517) 	at org.eclipse.ui.internal.NavigationHistory.backward(NavigationHistory.java:501) 	at org.eclipse.ui.internal.NavigationHistoryAction.run(NavigationHistoryAction.java:242) 	at org.eclipse.jface.action.Action.runWithEvent(Action.java:498) 	at org.eclipse.jface.commands.ActionHandler.execute(ActionHandler.java:121) 	at org.eclipse.ui.internal.handlers.E4HandlerProxy.execute(E4HandlerProxy.java:58) 	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) 	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:79) 	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) 	at java.lang.reflect.Method.invoke(Method.java:618) 	at org.eclipse.e4.core.internal.di.MethodRequestor.execute(MethodRequestor.java:52) 	at org.eclipse.e4.core.internal.di.InjectorImpl.invokeUsingClass(InjectorImpl.java:207) 	at org.eclipse.e4.core.internal.di.InjectorImpl.invoke(InjectorImpl.java:188) 	at org.eclipse.e4.core.contexts.ContextInjectionFactory.invoke(ContextInjectionFactory.java:123) 	at org.eclipse.e4.core.commands.internal.HandlerServiceImpl.executeHandler(HandlerServiceImpl.java:122) 	at org.eclipse.e4.ui.workbench.renderers.swt.ToolItemRenderer$8.widgetSelected(ToolItemRenderer.java:415) 	at org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:234) 	at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) 	at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1053) 	at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:4084) 	at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3675) 	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$6.run(PartRenderingEngine.java:780) 	at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) 	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:696) 	at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:91) 	at org.eclipse.ui.internal.Workbench$3.run(Workbench.java:542) 	at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) 	at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:524) 	at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149) java.lang.NullPointerException 	at org.eclipse.ui.operations.OperationHistoryActionHandler.<init>(OperationHistoryActionHandler.java:213) 	at org.eclipse.ui.operations.UndoActionHandler.<init>(UndoActionHandler.java:46) 	at org.eclipse.ui.texteditor.AbstractTextEditor.createUndoRedoActions(AbstractTextEditor.java:5595) 	at org.eclipse.ui.texteditor.AbstractTextEditor.createPartControl(AbstractTextEditor.java:3563) 	at org.eclipse.ui.texteditor.StatusTextEditor.createPartControl(StatusTextEditor.java:54) 	at org.eclipse.ui.texteditor.AbstractDecoratedTextEditor.createPartControl(AbstractDecoratedTextEditor.java:438) 	at org.eclipse.ui.internal.e4.compatibility.CompatibilityPart.createPartControl(CompatibilityPart.java:97) 	at org.eclipse.ui.internal.e4.compatibility.CompatibilityEditor.createPartControl(CompatibilityEditor.java:48) 	at org.eclipse.ui.internal.e4.compatibility.CompatibilityPart.create(CompatibilityPart.java:193) 	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) 	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:79) 	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) 	at java.lang.reflect.Method.invoke(Method.java:618) 	at org.eclipse.e4.core.internal.di.MethodRequestor.execute(MethodRequestor.java:52) 	at org.eclipse.e4.core.internal.di.InjectorImpl.processAnnotated(InjectorImpl.java:793) 	at org.eclipse.e4.core.internal.di.InjectorImpl.processAnnotated(InjectorImpl.java:773) 	at org.eclipse.e4.core.internal.di.InjectorImpl.inject(InjectorImpl.java:103) 	at org.eclipse.e4.core.internal.di.InjectorImpl.internalMake(InjectorImpl.java:291) 	at org.eclipse.e4.core.internal.di.InjectorImpl.make(InjectorImpl.java:218) 	at org.eclipse.e4.core.contexts.ContextInjectionFactory.make(ContextInjectionFactory.java:152) 	at org.eclipse.e4.ui.internal.workbench.ReflectionContributionFactory.createFromBundle(ReflectionContributionFactory.java:90) 	at org.eclipse.e4.ui.internal.workbench.ReflectionContributionFactory.doCreate(ReflectionContributionFactory.java:64) 	at org.eclipse.e4.ui.internal.workbench.ReflectionContributionFactory.create(ReflectionContributionFactory.java:53) 	at org.eclipse.e4.ui.workbench.renderers.swt.ContributedPartRenderer.createWidget(ContributedPartRenderer.java:117) 	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.createWidget(PartRenderingEngine.java:669) 	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.createGui(PartRenderingEngine.java:478) 	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.createGui(PartRenderingEngine.java:554) 	at org.eclipse.e4.ui.workbench.renderers.swt.StackRenderer.showTab(StackRenderer.java:516) 	at org.eclipse.e4.ui.workbench.renderers.swt.LazyStackRenderer$1.handleEvent(LazyStackRenderer.java:74) 	at org.eclipse.e4.ui.services.internal.events.UIEventHandler.handleEvent(UIEventHandler.java:41) 	at org.eclipse.equinox.internal.event.EventHandlerWrapper.handleEvent(EventHandlerWrapper.java:197) 	at org.eclipse.equinox.internal.event.EventHandlerTracker.dispatchEvent(EventHandlerTracker.java:197) 	at org.eclipse.equinox.internal.event.EventHandlerTracker.dispatchEvent(EventHandlerTracker.java:1) 	at org.eclipse.osgi.framework.eventmgr.EventManager.dispatchEvent(EventManager.java:230) 	at org.eclipse.osgi.framework.eventmgr.ListenerQueue.dispatchEventSynchronous(ListenerQueue.java:148) 	at org.eclipse.equinox.internal.event.EventAdminImpl.dispatchEvent(EventAdminImpl.java:135) 	at org.eclipse.equinox.internal.event.EventAdminImpl.sendEvent(EventAdminImpl.java:78) 	at org.eclipse.equinox.internal.event.EventComponent.sendEvent(EventComponent.java:39) 	at org.eclipse.e4.ui.services.internal.events.EventBroker.send(EventBroker.java:73) 	at org.eclipse.e4.ui.internal.workbench.UIEventPublisher.notifyChanged(UIEventPublisher.java:58) 	at org.eclipse.emf.common.notify.impl.BasicNotifierImpl.eNotify(BasicNotifierImpl.java:380) 	at org.eclipse.e4.ui.model.application.ui.impl.ElementContainerImpl.setSelectedElement(ElementContainerImpl.java:171) 	at org.eclipse.e4.ui.internal.workbench.ModelServiceImpl.showElementInWindow(ModelServiceImpl.java:259) 	at org.eclipse.e4.ui.internal.workbench.ModelServiceImpl.bringToTop(ModelServiceImpl.java:227) 	at org.eclipse.e4.ui.internal.workbench.PartServiceImpl.activate(PartServiceImpl.java:485) 	at org.eclipse.e4.ui.internal.workbench.PartServiceImpl.activate(PartServiceImpl.java:460) 	at org.eclipse.e4.ui.internal.workbench.PartServiceImpl.activate(PartServiceImpl.java:449) 	at org.eclipse.e4.ui.internal.workbench.PartServiceImpl.showPart(PartServiceImpl.java:848) 	at org.eclipse.ui.internal.WorkbenchPage.busyOpenEditor(WorkbenchPage.java:2259) 	at org.eclipse.ui.internal.WorkbenchPage.access$14(WorkbenchPage.java:2221) 	at org.eclipse.ui.internal.WorkbenchPage$6.run(WorkbenchPage.java:2203) 	at org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:70) 	at org.eclipse.ui.internal.WorkbenchPage.openEditor(WorkbenchPage.java:2199) 	at org.eclipse.ui.internal.WorkbenchPage.openEditor(WorkbenchPage.java:2183) 	at org.eclipse.ui.internal.WorkbenchPage.openEditor(WorkbenchPage.java:2174) 	at org.eclipse.ui.internal.NavigationHistoryEntry.restoreLocation(NavigationHistoryEntry.java:66) 	at org.eclipse.ui.internal.NavigationHistory.gotoEntry(NavigationHistory.java:452) 	at org.eclipse.ui.internal.NavigationHistory.shiftEntry(NavigationHistory.java:517) 	at org.eclipse.ui.internal.NavigationHistory.backward(NavigationHistory.java:501) 	at org.eclipse.ui.internal.NavigationHistoryAction.run(NavigationHistoryAction.java:242) 	at org.eclipse.jface.action.Action.runWithEvent(Action.java:498) 	at org.eclipse.jface.commands.ActionHandler.execute(ActionHandler.java:121) 	at org.eclipse.ui.internal.handlers.E4HandlerProxy.execute(E4HandlerProxy.java:58) 	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) 	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:79) 	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) 	at java.lang.reflect.Method.invoke(Method.java:618) 	at org.eclipse.e4.core.internal.di.MethodRequestor.execute(MethodRequestor.java:52) 	at org.eclipse.e4.core.internal.di.InjectorImpl.invokeUsingClass(InjectorImpl.java:207) 	at org.eclipse.e4.core.internal.di.InjectorImpl.invoke(InjectorImpl.java:188) 	at org.eclipse.e4.core.contexts.ContextInjectionFactory.invoke(ContextInjectionFactory.java:123) 	at org.eclipse.e4.core.commands.internal.HandlerServiceImpl.executeHandler(HandlerServiceImpl.java:122) 	at org.eclipse.e4.ui.workbench.renderers.swt.ToolItemRenderer$8.widgetSelected(ToolItemRenderer.java:415) 	at org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:234) 	at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) 	at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1053) 	at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:4084) 	at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3675) 	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$6.run(PartRenderingEngine.java:780) 	at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) 	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:696) 	at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:91) 	at org.eclipse.ui.internal.Workbench$3.run(Workbench.java:542) 	at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) 	at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:524) 	at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149) java.lang.NullPointerException 	at org.eclipse.ui.internal.e4.compatibility.SelectionService.selectionChanged(SelectionService.java:280) 	at org.eclipse.jface.viewers.Viewer$2.run(Viewer.java:164) 	at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) 	at org.eclipse.ui.internal.JFaceUtil$1.run(JFaceUtil.java:49) 	at org.eclipse.jface.util.SafeRunnable.run(SafeRunnable.java:175) 	at org.eclipse.jface.viewers.Viewer.fireSelectionChanged(Viewer.java:162) 	at org.eclipse.jface.text.TextViewer.fireSelectionChanged(TextViewer.java:2729) 	at org.eclipse.jface.text.TextViewer.selectionChanged(TextViewer.java:2708) 	at org.eclipse.jface.text.TextViewer.setSelectedRange(TextViewer.java:2393) 	at org.eclipse.ui.texteditor.AbstractTextEditor.selectAndReveal(AbstractTextEditor.java:6302) 	at org.eclipse.ui.texteditor.AbstractTextEditor.selectAndReveal(AbstractTextEditor.java:6273) 	at org.eclipse.ui.texteditor.TextSelectionNavigationLocation.restoreLocation(TextSelectionNavigationLocation.java:254) 	at org.eclipse.ui.internal.NavigationHistoryEntry.restoreLocation(NavigationHistoryEntry.java:81) 	at org.eclipse.ui.internal.NavigationHistory.gotoEntry(NavigationHistory.java:452) 	at org.eclipse.ui.internal.NavigationHistory.shiftEntry(NavigationHistory.java:517) 	at org.eclipse.ui.internal.NavigationHistory.backward(NavigationHistory.java:501) 	at org.eclipse.ui.internal.NavigationHistoryAction.run(NavigationHistoryAction.java:242) 	at org.eclipse.jface.action.Action.runWithEvent(Action.java:498) 	at org.eclipse.jface.commands.ActionHandler.execute(ActionHandler.java:121) 	at org.eclipse.ui.internal.handlers.E4HandlerProxy.execute(E4HandlerProxy.java:58) 	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) 	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:79) 	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) 	at java.lang.reflect.Method.invoke(Method.java:618) 	at org.eclipse.e4.core.internal.di.MethodRequestor.execute(MethodRequestor.java:52) 	at org.eclipse.e4.core.internal.di.InjectorImpl.invokeUsingClass(InjectorImpl.java:207) 	at org.eclipse.e4.core.internal.di.InjectorImpl.invoke(InjectorImpl.java:188) 	at org.eclipse.e4.core.contexts.ContextInjectionFactory.invoke(ContextInjectionFactory.java:123) 	at org.eclipse.e4.core.commands.internal.HandlerServiceImpl.executeHandler(HandlerServiceImpl.java:122) 	at org.eclipse.e4.ui.workbench.renderers.swt.ToolItemRenderer$8.widgetSelected(ToolItemRenderer.java:415) 	at org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:234) 	at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) 	at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1053) 	at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:4084) 	at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3675) 	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$6.run(PartRenderingEngine.java:780) 	at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) 	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:696) 	at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:91) 	at org.eclipse.ui.internal.Workbench$3.run(Workbench.java:542) 	at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) 	at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:524) 	at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149) 	at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:115) java.lang.NullPointerException 	at org.eclipse.ui.texteditor.AbstractTextEditor.markInNavigationHistory(AbstractTextEditor.java:6329) 	at org.eclipse.ui.texteditor.AbstractTextEditor.selectAndReveal(AbstractTextEditor.java:6304) 	at org.eclipse.ui.texteditor.AbstractTextEditor.selectAndReveal(AbstractTextEditor.java:6273) 	at org.eclipse.ui.texteditor.TextSelectionNavigationLocation.restoreLocation(TextSelectionNavigationLocation.java:254) 	at org.eclipse.ui.internal.NavigationHistoryEntry.restoreLocation(NavigationHistoryEntry.java:81) 	at org.eclipse.ui.internal.NavigationHistory.gotoEntry(NavigationHistory.java:452) 	at org.eclipse.ui.internal.NavigationHistory.shiftEntry(NavigationHistory.java:517) 	at org.eclipse.ui.internal.NavigationHistory.backward(NavigationHistory.java:501) 	at org.eclipse.ui.internal.NavigationHistoryAction.run(NavigationHistoryAction.java:242) 	at org.eclipse.jface.action.Action.runWithEvent(Action.java:498) 	at org.eclipse.jface.commands.ActionHandler.execute(ActionHandler.java:121) 	at org.eclipse.ui.internal.handlers.E4HandlerProxy.execute(E4HandlerProxy.java:58) 	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) 	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:79) 	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) 	at java.lang.reflect.Method.invoke(Method.java:618) 	at org.eclipse.e4.core.internal.di.MethodRequestor.execute(MethodRequestor.java:52) 	at org.eclipse.e4.core.internal.di.InjectorImpl.invokeUsingClass(InjectorImpl.java:207) 	at org.eclipse.e4.core.internal.di.InjectorImpl.invoke(InjectorImpl.java:188) 	at org.eclipse.e4.core.contexts.ContextInjectionFactory.invoke(ContextInjectionFactory.java:123) 	at org.eclipse.e4.core.commands.internal.HandlerServiceImpl.executeHandler(HandlerServiceImpl.java:122) 	at org.eclipse.e4.ui.workbench.renderers.swt.ToolItemRenderer$8.widgetSelected(ToolItemRenderer.java:415) 	at org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:234) 	at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) 	at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1053) 	at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:4084) 	at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3675) 	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$6.run(PartRenderingEngine.java:780) 	at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) 	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:696) 	at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:91) 	at org.eclipse.ui.internal.Workbench$3.run(Workbench.java:542) 	at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) 	at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:524) 	at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149) java.lang.NullPointerException 	at org.eclipse.ui.internal.e4.compatibility.SelectionService.selectionChanged(SelectionService.java:280) 	at org.eclipse.jface.text.TextViewer.firePostSelectionChanged(TextViewer.java:2746) 	at org.eclipse.jface.text.TextViewer.firePostSelectionChanged(TextViewer.java:2694) 	at org.eclipse.jface.text.TextViewer$5.run(TextViewer.java:2673) 	at org.eclipse.swt.widgets.Display.runTimer(Display.java:4185) 	at org.eclipse.swt.widgets.Display.messageProc(Display.java:3274) 	at org.eclipse.swt.internal.win32.OS.DispatchMessageW(Native Method) 	at org.eclipse.swt.internal.win32.OS.DispatchMessage(OS.java:2461) 	at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3673) 	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$6.run(PartRenderingEngine.java:780) 	at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) 	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:696) 	at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:91) 	at org.eclipse.ui.internal.Workbench$3.run(Workbench.java:542) 	at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) 	at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:524) 	at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)