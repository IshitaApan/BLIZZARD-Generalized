[Workbench] WorkbenchLabelProvider leaks

+++ This bug was initially created as a clone of Bug #231175 +++ Every image allocated by WorkbenchLabelProvider is leaked. 1. The images are not disposed when the elements are no longer used by the viewer (fixing this would require a way for the viewer to tell the label provider when each element is no longer needed) 2. The images are not disposed when the label provider itself is disposed. Item 1 is a would-be-nice issue. Item 2 is more serious. The label provider should be using a LocalResourceManager to allocate its images, and it should dispose the resource manager when the label provider goes away. 6 Images 6 Images at: java.lang.Error 	at org.eclipse.swt.graphics.Device.new_Object(Device.java:708) 	at org.eclipse.swt.graphics.Image.<init>(Image.java:446) 	at org.eclipse.jface.resource.ImageDescriptor.createImage(ImageDescriptor.java:289) 	at org.eclipse.jface.resource.ImageDescriptor.createImage(ImageDescriptor.java:227) 	at org.eclipse.jface.resource.ImageDescriptor.createImage(ImageDescriptor.java:205) 	at org.eclipse.ui.model.WorkbenchLabelProvider.getImage(WorkbenchLabelProvider.java:157) 	at org.eclipse.jface.viewers.WrappedViewerLabelProvider.getImage(WrappedViewerLabelProvider.java:117) 	at org.eclipse.jface.viewers.WrappedViewerLabelProvider.update(WrappedViewerLabelProvider.java:165) 	at org.eclipse.jface.viewers.ViewerColumn.refresh(ViewerColumn.java:135) 	at org.eclipse.jface.viewers.AbstractTreeViewer.doUpdateItem(AbstractTreeViewer.java:911) 	at org.eclipse.jface.viewers.AbstractTreeViewer$UpdateItemSafeRunnable.run(AbstractTreeViewer.java:97) 	at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:37) 	at org.eclipse.core.runtime.Platform.run(Platform.java:857) 	at org.eclipse.ui.internal.JFaceUtil$1.run(JFaceUtil.java:46) 	at org.eclipse.jface.util.SafeRunnable.run(SafeRunnable.java:199) 	at org.eclipse.jface.viewers.AbstractTreeViewer.doUpdateItem(AbstractTreeViewer.java:991) 	at org.eclipse.jface.viewers.StructuredViewer$UpdateItemSafeRunnable.run(StructuredViewer.java:466) 	at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:37) 	at org.eclipse.core.runtime.Platform.run(Platform.java:857) 	at org.eclipse.ui.internal.JFaceUtil$1.run(JFaceUtil.java:46) 	at org.eclipse.jface.util.SafeRunnable.run(SafeRunnable.java:199) 	at org.eclipse.jface.viewers.StructuredViewer.updateItem(StructuredViewer.java:2026) 	at org.eclipse.jface.viewers.AbstractTreeViewer.createTreeItem(AbstractTreeViewer.java:806) 	at org.eclipse.jface.viewers.AbstractTreeViewer$1.run(AbstractTreeViewer.java:781) 	at org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:67) 	at org.eclipse.jface.viewers.AbstractTreeViewer.createChildren(AbstractTreeViewer.java:755) 	at org.eclipse.jface.viewers.TreeViewer.createChildren(TreeViewer.java:627) 	at org.eclipse.jface.viewers.AbstractTreeViewer.internalInitializeTree(AbstractTreeViewer.java:1463) 	at org.eclipse.jface.viewers.TreeViewer.internalInitializeTree(TreeViewer.java:816) 	at org.eclipse.jface.viewers.AbstractTreeViewer$5.run(AbstractTreeViewer.java:1446) 	at org.eclipse.jface.viewers.StructuredViewer.preservingSelection(StructuredViewer.java:1368) 	at org.eclipse.jface.viewers.TreeViewer.preservingSelection(TreeViewer.java:390) 	at org.eclipse.jface.viewers.StructuredViewer.preservingSelection(StructuredViewer.java:1330) 	at org.eclipse.jface.viewers.AbstractTreeViewer.inputChanged(AbstractTreeViewer.java:1435) 	at org.eclipse.ui.dialogs.FilteredTree$NotifyingTreeViewer.inputChanged(FilteredTree.java:797) 	at org.eclipse.jface.viewers.ContentViewer.setInput(ContentViewer.java:251) 	at org.eclipse.jface.viewers.StructuredViewer.setInput(StructuredViewer.java:1606) 	at org.eclipse.ui.internal.dialogs.NewWizardNewPage.createFilteredTree(NewWizardNewPage.java:332) 	at org.eclipse.ui.internal.dialogs.NewWizardNewPage.createControl(NewWizardNewPage.java:254) 	at org.eclipse.ui.internal.dialogs.NewWizardSelectionPage.createControl(NewWizardSelectionPage.java:88) 	at org.eclipse.jface.wizard.Wizard.createPageControls(Wizard.java:170) 	at org.eclipse.jface.wizard.WizardDialog.createPageControls(WizardDialog.java:669) 	at org.eclipse.jface.wizard.WizardDialog.createContents(WizardDialog.java:543) 	at org.eclipse.jface.window.Window.create(Window.java:426) 	at org.eclipse.jface.dialogs.Dialog.create(Dialog.java:1083) 	at org.eclipse.ui.actions.NewProjectAction.run(NewProjectAction.java:108) 	at org.eclipse.jface.action.Action.runWithEvent(Action.java:498) 	at org.eclipse.jface.action.ActionContributionItem.handleWidgetSelection(ActionContributionItem.java:546) 	at org.eclipse.jface.action.ActionContributionItem.access$2(ActionContributionItem.java:490) 	at org.eclipse.jface.action.ActionContributionItem$5.handleEvent(ActionContributionItem.java:402) 	at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:66) 	at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1101) 	at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:3319) 	at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2971) 	at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2389) 	at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2353) 	at org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2219) 	at org.eclipse.ui.internal.Workbench$4.run(Workbench.java:466) 	at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:289) 	at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:461) 	at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149) 	at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:106) 	at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:169) 	at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:106) 	at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:76) 	at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:363) 	at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:176) 	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) 	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:79) 	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) 	at java.lang.reflect.Method.invoke(Method.java:618) 	at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:508) 	at org.eclipse.equinox.launcher.Main.basicRun(Main.java:447) 	at org.eclipse.equinox.launcher.Main.run(Main.java:1173) 	at org.eclipse.equinox.launcher.Main.main(Main.java:1148)