[Workbench] Workbench.shutdown() doesn't complete due to exception

+++ This bug was initially created as a clone of Bug #256839 +++ Build ID: v20080903-1122 Steps To Reproduce: This problem occurs using WID6.2 11/26/2008 build, which is based on top of RAD7.5.1. However, the problem is with Workbench.shutdown() method. I sent corresponding note to Boris and Philippe. These steps to reproduce Eclipse problem are WID-specific, but problem is not. 1. start WID 2. start WPS 3. bring up an Admin console - by default, internal browser comes up (no need to log in) 4. without closing internal browser window, change 'Web browser' preference to open an external browser 5. bring up Admin console again - this time it comes up in an external browser (again, no need to log in) 6. shut down WPS 7. close WID NOTE: there is a ClassCast exception that occurs - this is a known RAD problem, but as a result, I see an error message box flash by and go away immediately. After that, javaw.exe stays around for over 10 minutes. I see an SWT exception in the .log, which seem to be thrown during Workbench.shutdown( ) processing. I believe that due to this exception, shutdown processing does not complete and many threads do not get a signal to go away. More information: Stack Trace: !ENTRY org.eclipse.jface 4 0 2008-11-26 16:05:20.812 !MESSAGE Unhandled event loop exception during blocked modal context. !STACK 0 org.eclipse.swt.SWTException: Failed to execute runnable (org.eclipse.swt.SWTException: Widget is disposed) 	at org.eclipse.swt.SWT.error(Unknown Source) 	at org.eclipse.swt.SWT.error(Unknown Source) 	at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Unknown Source) 	at org.eclipse.swt.widgets.Display.runAsyncMessages(Unknown Source) 	at org.eclipse.swt.widgets.Display.readAndDispatch(Unknown Source) 	at org.eclipse.jface.operation.ModalContext$ModalContextThread.block(Unknown Source) 	at org.eclipse.jface.operation.ModalContext.run(Unknown Source) 	at org.eclipse.jface.dialogs.ProgressMonitorDialog.run(Unknown Source) 	at org.eclipse.ui.internal.progress.ProgressMonitorJobsDialog.run(Unknown Source) 	at org.eclipse.ui.internal.ide.application.IDEWorkbenchAdvisor.disconnectFromWorkspace(Unknown Source) 	at org.eclipse.ui.internal.ide.application.IDEWorkbenchAdvisor.postShutdown(Unknown Source) 	at org.eclipse.ui.internal.Workbench.shutdown(Unknown Source) 	at org.eclipse.ui.internal.Workbench.busyClose(Unknown Source) 	at org.eclipse.ui.internal.Workbench.access$15(Unknown Source) 	at org.eclipse.ui.internal.Workbench$23.run(Unknown Source) 	at org.eclipse.swt.custom.BusyIndicator.showWhile(Unknown Source) 	at org.eclipse.ui.internal.Workbench.close(Unknown Source) 	at org.eclipse.ui.internal.Workbench.close(Unknown Source) 	at org.eclipse.ui.internal.WorkbenchWindow.busyClose(Unknown Source) 	at org.eclipse.ui.internal.WorkbenchWindow.access$0(Unknown Source) 	at org.eclipse.ui.internal.WorkbenchWindow$3.run(Unknown Source) 	at org.eclipse.swt.custom.BusyIndicator.showWhile(Unknown Source) 	at org.eclipse.ui.internal.WorkbenchWindow.close(Unknown Source) 	at org.eclipse.jface.window.Window.handleShellCloseEvent(Unknown Source) 	at org.eclipse.jface.window.Window$3.shellClosed(Unknown Source) 	at org.eclipse.swt.widgets.TypedListener.handleEvent(Unknown Source) 	at org.eclipse.swt.widgets.EventTable.sendEvent(Unknown Source) 	at org.eclipse.swt.widgets.Widget.sendEvent(Unknown Source) 	at org.eclipse.swt.widgets.Widget.sendEvent(Unknown Source) 	at org.eclipse.swt.widgets.Widget.sendEvent(Unknown Source) 	at org.eclipse.swt.widgets.Decorations.closeWidget(Unknown Source) 	at org.eclipse.swt.widgets.Decorations.WM_CLOSE(Unknown Source) 	at org.eclipse.swt.widgets.Control.windowProc(Unknown Source) 	at org.eclipse.swt.widgets.Canvas.windowProc(Unknown Source) 	at org.eclipse.swt.widgets.Decorations.windowProc(Unknown Source) 	at org.eclipse.swt.widgets.Shell.windowProc(Unknown Source) 	at org.eclipse.swt.widgets.Display.windowProc(Unknown Source) 	at org.eclipse.swt.internal.win32.OS.DefWindowProcW(Native Method) 	at org.eclipse.swt.internal.win32.OS.DefWindowProc(Unknown Source) 	at org.eclipse.swt.widgets.Shell.callWindowProc(Unknown Source) 	at org.eclipse.swt.widgets.Control.windowProc(Unknown Source) 	at org.eclipse.swt.widgets.Canvas.windowProc(Unknown Source) 	at org.eclipse.swt.widgets.Decorations.windowProc(Unknown Source) 	at org.eclipse.swt.widgets.Shell.windowProc(Unknown Source) 	at org.eclipse.swt.widgets.Display.windowProc(Unknown Source) 	at org.eclipse.swt.internal.win32.OS.DefWindowProcW(Native Method) 	at org.eclipse.swt.internal.win32.OS.DefWindowProc(Unknown Source) 	at org.eclipse.swt.widgets.Shell.callWindowProc(Unknown Source) 	at org.eclipse.swt.widgets.Control.windowProc(Unknown Source) 	at org.eclipse.swt.widgets.Canvas.windowProc(Unknown Source) 	at org.eclipse.swt.widgets.Decorations.windowProc(Unknown Source) 	at org.eclipse.swt.widgets.Shell.windowProc(Unknown Source) 	at org.eclipse.swt.widgets.Display.windowProc(Unknown Source) 	at org.eclipse.swt.internal.win32.OS.DispatchMessageW(Native Method) 	at org.eclipse.swt.internal.win32.OS.DispatchMessage(Unknown Source) 	at org.eclipse.swt.widgets.Display.readAndDispatch(Unknown Source) 	at org.eclipse.ui.internal.Workbench.runEventLoop(Unknown Source) 	at org.eclipse.ui.internal.Workbench.runUI(Unknown Source) 	at org.eclipse.ui.internal.Workbench.access$4(Unknown Source) 	at org.eclipse.ui.internal.Workbench$5.run(Unknown Source) 	at org.eclipse.core.databinding.observable.Realm.runWithDefault(Unknown Source) 	at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Unknown Source) 	at org.eclipse.ui.PlatformUI.createAndRunWorkbench(Unknown Source) 	at org.eclipse.ui.internal.ide.application.IDEApplication.start(Unknown Source) 	at org.eclipse.equinox.internal.app.EclipseAppHandle.run(Unknown Source) 	at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(Unknown Source) 	at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(Unknown Source) 	at org.eclipse.core.runtime.adaptor.EclipseStarter.run(Unknown Source) 	at org.eclipse.core.runtime.adaptor.EclipseStarter.run(Unknown Source) 	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) 	at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source) 	at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source) 	at java.lang.reflect.Method.invoke(Unknown Source) 	at org.eclipse.equinox.launcher.Main.invokeFramework(Unknown Source) 	at org.eclipse.equinox.launcher.Main.basicRun(Unknown Source) 	at org.eclipse.equinox.launcher.Main.run(Unknown Source) 	at org.eclipse.equinox.launcher.Main.main(Unknown Source) Caused by: org.eclipse.swt.SWTException: Widget is disposed 	at org.eclipse.swt.SWT.error(Unknown Source) 	at org.eclipse.swt.SWT.error(Unknown Source) 	at org.eclipse.swt.SWT.error(Unknown Source) 	at org.eclipse.swt.widgets.Widget.error(Unknown Source) 	at org.eclipse.swt.widgets.Widget.checkWidget(Unknown Source) 	at org.eclipse.swt.widgets.Control.setBounds(Unknown Source) 	at org.eclipse.ui.internal.DefaultAnimationFeedback.jobInit(Unknown Source) 	at org.eclipse.ui.internal.RectangleAnimation$2.run(Unknown Source) 	at org.eclipse.ui.internal.UILockListener.doPendingWork(Unknown Source) 	at org.eclipse.ui.internal.UISynchronizer$3.run(Unknown Source) 	at org.eclipse.swt.widgets.RunnableLock.run(Unknown Source) 	... 75 more