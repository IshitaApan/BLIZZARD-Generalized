import wizard throws uncaught exception

When using WizardImportResourcePage to create an import wizard, a casting exception occurs under the following conditions: project or Java source folder is selected Import... is selected from the context menu The exception occurs when the following code is encountered: protected WizardImportResourcePage(String name, IStructuredSelection selection) { 	super(name); 	if (selection.size() == 1) 		currentResourceSelection = (IResource) selection.getFirstElement(); 	else 		currentResourceSelection = null; 	if (currentResourceSelection != null) { 		if (currentResourceSelection.getType() == IResource.FILE) 			currentResourceSelection = currentResourceSelection.getParent(); 		if (!currentResourceSelection.isAccessible()) 			currentResourceSelection = null; 	} }