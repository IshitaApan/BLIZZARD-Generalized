[ActivityMgmt] WorkbenchActivityHelper restrictArray is returning NULL for objects failing the test "restrictUseOf(Object)"

Patch from bug 278734 attachment 144217 +++ This bug was initially created as a clone of Bug #278734 +++ Build ID: M20090211-1700 Steps To Reproduce: Package org.eclipse.ui.activities; Class WorkbenchActivityHelper Method restrictArray In case we are using Activities to filter out e.g some editors for specific IContentType, the restrictArray method should return a list with a size equal to the number of objects passing the test "restrictUseOf(Object)". Instead, it is returning a list with the size of the input Array, which will return NULL for those objects not passing the test. Proposed solution: The line: return list.toArray((Object[]) Array.newInstance(array.getClass().getComponentType(), array.length)); should be replaced by: return list.toArray((Object[]) Array.newInstance(array.getClass().getComponentType(), list.size())); More information: