Error in editor initialization cause NPE in accessing compatibility editor

In our application we have our own SvgEditor (indirectly derived from org.eclipse.ui.part.EditorPart) class that in its initialize method loads an SVG image, and throws an exception (DOMException) when the image is invalid. In Eclipse Indigo, this exception was nicely propagated, and the code that tried to open the editor could catch it. With Eclipse Juno, loading the editor obviously still fails. But now, in WorkbenchPage.busyOpenEditor, local variable compatibilityEditor becomes null, due to the editor failing to load. At the end of that method however, "return compatibilityEditor.getEditor();" is executed, giving a NPE. This is the stack trace for the NPE: java.lang.NullPointerException 	at org.eclipse.ui.internal.WorkbenchPage.busyOpenEditor(WorkbenchPage.java:3087) 	at org.eclipse.ui.internal.WorkbenchPage.access$21(WorkbenchPage.java:2996) 	at org.eclipse.ui.internal.WorkbenchPage$8.run(WorkbenchPage.java:2978) 	at org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:70) 	at org.eclipse.ui.internal.WorkbenchPage.openEditor(WorkbenchPage.java:2974) 	at org.eclipse.ui.internal.WorkbenchPage.openEditor(WorkbenchPage.java:2933) 	at org.eclipse.ui.internal.WorkbenchPage.openEditor(WorkbenchPage.java:2916) 	at nl.tue.common.eclipse.ui.ControlEditor$2.run(ControlEditor.java:199) 	at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35) 	at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:135) 	at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:3529) 	at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3182) 	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$9.run(PartRenderingEngine.java:1022) 	at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) 	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:916) 	at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:86) 	at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:585) 	at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) 	at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:540) 	at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149) 	at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:124) 	at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196) 	at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110) 	at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79) 	at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:353) 	at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:180) 	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) 	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) 	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) 	at java.lang.reflect.Method.invoke(Method.java:597) 	at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:629) 	at org.eclipse.equinox.launcher.Main.basicRun(Main.java:584) 	at org.eclipse.equinox.launcher.Main.run(Main.java:1438) 	at org.eclipse.equinox.launcher.Main.main(Main.java:1414) When the editor fails to load, e4 logs an exception (before getting to the part about the NPE): org.eclipse.e4.core.di.InjectionException: org.w3c.dom.DOMException: invalid.element 	at org.eclipse.e4.core.internal.di.MethodRequestor.execute(MethodRequestor.java:63) 	at org.eclipse.e4.core.internal.di.InjectorImpl.processAnnotated(InjectorImpl.java:857) 	at org.eclipse.e4.core.internal.di.InjectorImpl.processAnnotated(InjectorImpl.java:837) 	at org.eclipse.e4.core.internal.di.InjectorImpl.inject(InjectorImpl.java:111) 	at org.eclipse.e4.core.internal.di.InjectorImpl.internalMake(InjectorImpl.java:318) 	at org.eclipse.e4.core.internal.di.InjectorImpl.make(InjectorImpl.java:240) 	at org.eclipse.e4.core.contexts.ContextInjectionFactory.make(ContextInjectionFactory.java:161) 	at org.eclipse.e4.ui.internal.workbench.ReflectionContributionFactory.createFromBundle(ReflectionContributionFactory.java:102) 	at org.eclipse.e4.ui.internal.workbench.ReflectionContributionFactory.doCreate(ReflectionContributionFactory.java:71) 	at org.eclipse.e4.ui.internal.workbench.ReflectionContributionFactory.create(ReflectionContributionFactory.java:53) 	at org.eclipse.e4.ui.workbench.renderers.swt.ContributedPartRenderer.createWidget(ContributedPartRenderer.java:141) 	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.createWidget(PartRenderingEngine.java:889) 	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.safeCreateGui(PartRenderingEngine.java:623) 	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.safeCreateGui(PartRenderingEngine.java:725) 	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.access$2(PartRenderingEngine.java:696) 	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$7.run(PartRenderingEngine.java:690) 	at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) 	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.createGui(PartRenderingEngine.java:675) 	at org.eclipse.e4.ui.internal.workbench.PartServiceImpl$1.handleEvent(PartServiceImpl.java:90) 	at org.eclipse.e4.ui.services.internal.events.UIEventHandler$1.run(UIEventHandler.java:41) 	at org.eclipse.swt.widgets.Synchronizer.syncExec(Synchronizer.java:180) 	at org.eclipse.ui.internal.UISynchronizer.syncExec(UISynchronizer.java:150) 	at org.eclipse.swt.widgets.Display.syncExec(Display.java:4291) 	at org.eclipse.e4.ui.internal.workbench.swt.E4Application$1.syncExec(E4Application.java:187) 	at org.eclipse.e4.ui.services.internal.events.UIEventHandler.handleEvent(UIEventHandler.java:38) 	at org.eclipse.equinox.internal.event.EventHandlerWrapper.handleEvent(EventHandlerWrapper.java:197) 	at org.eclipse.equinox.internal.event.EventHandlerTracker.dispatchEvent(EventHandlerTracker.java:197) 	at org.eclipse.equinox.internal.event.EventHandlerTracker.dispatchEvent(EventHandlerTracker.java:1) 	at org.eclipse.osgi.framework.eventmgr.EventManager.dispatchEvent(EventManager.java:230) 	at org.eclipse.osgi.framework.eventmgr.ListenerQueue.dispatchEventSynchronous(ListenerQueue.java:148) 	at org.eclipse.equinox.internal.event.EventAdminImpl.dispatchEvent(EventAdminImpl.java:135) 	at org.eclipse.equinox.internal.event.EventAdminImpl.sendEvent(EventAdminImpl.java:78) 	at org.eclipse.equinox.internal.event.EventComponent.sendEvent(EventComponent.java:39) 	at org.eclipse.e4.ui.services.internal.events.EventBroker.send(EventBroker.java:81) 	at org.eclipse.e4.ui.internal.workbench.UIEventPublisher.notifyChanged(UIEventPublisher.java:57) 	at org.eclipse.emf.common.notify.impl.BasicNotifierImpl.eNotify(BasicNotifierImpl.java:374) 	at org.eclipse.e4.ui.model.application.ui.impl.ElementContainerImpl.setSelectedElement(ElementContainerImpl.java:171) 	at org.eclipse.e4.ui.internal.workbench.ModelServiceImpl.showElementInWindow(ModelServiceImpl.java:418) 	at org.eclipse.e4.ui.internal.workbench.ModelServiceImpl.bringToTop(ModelServiceImpl.java:385) 	at org.eclipse.e4.ui.internal.workbench.PartServiceImpl.delegateBringToTop(PartServiceImpl.java:578) 	at org.eclipse.e4.ui.internal.workbench.PartServiceImpl.bringToTop(PartServiceImpl.java:314) 	at org.eclipse.e4.ui.internal.workbench.PartServiceImpl.showPart(PartServiceImpl.java:962) 	at org.eclipse.ui.internal.WorkbenchPage.busyOpenEditor(WorkbenchPage.java:3071) 	at org.eclipse.ui.internal.WorkbenchPage.access$21(WorkbenchPage.java:2996) 	at org.eclipse.ui.internal.WorkbenchPage$8.run(WorkbenchPage.java:2978) 	at org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:70) 	at org.eclipse.ui.internal.WorkbenchPage.openEditor(WorkbenchPage.java:2974) 	at org.eclipse.ui.internal.WorkbenchPage.openEditor(WorkbenchPage.java:2933) 	at org.eclipse.ui.internal.WorkbenchPage.openEditor(WorkbenchPage.java:2916) 	at nl.tue.common.eclipse.ui.ControlEditor$2.run(ControlEditor.java:199) 	at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35) 	at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:135) 	at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:3529) 	at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3182) 	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$9.run(PartRenderingEngine.java:1022) 	at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) 	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:916) 	at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:86) 	at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:585) 	at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) 	at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:540) 	at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149) 	at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:124) 	at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196) 	at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110) 	at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79) 	at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:353) 	at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:180) 	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) 	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) 	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) 	at java.lang.reflect.Method.invoke(Method.java:597) 	at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:629) 	at org.eclipse.equinox.launcher.Main.basicRun(Main.java:584) 	at org.eclipse.equinox.launcher.Main.run(Main.java:1438) 	at org.eclipse.equinox.launcher.Main.main(Main.java:1414) Caused by: org.w3c.dom.DOMException: invalid.element 	at org.apache.batik.dom.AbstractNode.createDOMException(Unknown Source) 	at org.apache.batik.dom.svg.SVGDOMImplementation.createElementNS(Unknown Source) 	at org.apache.batik.dom.svg.SVGOMDocument.createElementNS(Unknown Source) 	at org.apache.batik.dom.util.SAXDocumentFactory.startElement(Unknown Source) 	at org.apache.xerces.parsers.AbstractSAXParser.startElement(Unknown Source) 	at org.apache.xerces.impl.XMLNSDocumentScannerImpl.scanStartElement(Unknown Source) 	at org.apache.xerces.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown Source) 	at org.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown Source) 	at org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source) 	at org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source) 	at org.apache.xerces.parsers.XMLParser.parse(Unknown Source) 	at org.apache.xerces.parsers.AbstractSAXParser.parse(Unknown Source) 	at org.apache.batik.dom.util.SAXDocumentFactory.createDocument(Unknown Source) 	at org.apache.batik.dom.util.SAXDocumentFactory.createDocument(Unknown Source) 	at org.apache.batik.dom.svg.SAXSVGDocumentFactory.createDocument(Unknown Source) 	at nl.tue.cif.v2x1x1.simulator.outputs.svg.SvgEditor.initialize(SvgEditor.java:131) 	at nl.tue.common.eclipse.ui.ControlEditor.init(ControlEditor.java:61) 	at org.eclipse.ui.internal.EditorReference.initialize(EditorReference.java:324) 	at org.eclipse.ui.internal.e4.compatibility.CompatibilityPart.create(CompatibilityPart.java:288) 	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) 	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) 	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) 	at java.lang.reflect.Method.invoke(Method.java:597) 	at org.eclipse.e4.core.internal.di.MethodRequestor.execute(MethodRequestor.java:56) 	... 75 more Somehow the exception is not forwarded, but logged, resulting in the code to continue, and thus resulting in the NPE. I use: Eclipse Modeling Tools, Version: Juno Release, Build id: 20120620-1657