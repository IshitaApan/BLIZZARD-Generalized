[Compatibility] NPE thrown when restoring workbench with an editor in a detached window

Caused by: java.lang.NullPointerException 	at org.eclipse.ui.internal.PartSite.getTopLevelModelWindow(PartSite.java:403) 	at org.eclipse.ui.internal.PartSite.setWindow(PartSite.java:200) 	at org.eclipse.ui.internal.PartSite.<init>(PartSite.java:177) 	at org.eclipse.ui.internal.EditorSite.<init>(EditorSite.java:44) 	at org.eclipse.ui.internal.EditorReference.initialize(EditorReference.java:325) 	at org.eclipse.ui.internal.e4.compatibility.CompatibilityPart.create(CompatibilityPart.java:169) 	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) 	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:48) 	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37) 	at java.lang.reflect.Method.invoke(Method.java:600) 	at org.eclipse.e4.core.internal.di.MethodRequestor.execute(MethodRequestor.java:52) 	... 57 more