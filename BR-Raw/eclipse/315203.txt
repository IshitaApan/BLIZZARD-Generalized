[Compatibility] Cannot close a workspace with editor missing

Created attachment 170628 Full stack traces I opened my workspace with the 4.0 SDK I20100531-2039, but I had not installed XML editors and tools. On startup I got an error message: 2010-06-01 08:23:05.341 Log ErrorException while dispatching event org.osgi.service.event.Event [topic=org/eclipse/e4/ui/model/ui/Context/context/SET] to handler org.eclipse.e4.ui.services.internal.events.UIEventHandler@57c757c7 org.eclipse.e4.core.di.InjectionException: org.eclipse.e4.core.di.InjectionException: java.lang.NullPointerException ... Caused by: java.lang.NullPointerException at org.eclipse.ui.internal.EditorReference.<init>(EditorReference.java:87) at org.eclipse.ui.internal.WorkbenchPage.createEditorReferenceForPart(WorkbenchPage.java:546) at org.eclipse.ui.internal.WorkbenchPage.setup(WorkbenchPage.java:1673) but eclipse came up. But it would not shut down, it just opened an error dialog and stayed up: !ENTRY org.eclipse.ui.workbench 4 2 2010-06-01 08:31:22.794 !MESSAGE Problems occurred when invoking code from plug-in: "org.eclipse.ui.workbench". !STACK 0 java.lang.NullPointerException 	at org.eclipse.ui.internal.ide.WorkbenchActionBuilder.dispose(WorkbenchActionBuilder.java:774) 	at org.eclipse.ui.internal.WorkbenchWindow.hardClose(WorkbenchWindow.java:982) 	at org.eclipse.ui.internal.WorkbenchWindow.busyClose(WorkbenchWindow.java:694) 	at org.eclipse.ui.internal.WorkbenchWindow.access$3(WorkbenchWindow.java:673) The full stack traces are in the attachment. PW