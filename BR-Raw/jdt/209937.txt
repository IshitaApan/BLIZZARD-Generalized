[push down] NPE in push down refactoring operation

When I attempted to push down a method using the Push Down entry in the refactoring menu I got the following NPE. STEPS 1) Add the following method to TreeViewer /* (non-Javadoc) 	 * @see org.eclipse.jface.viewers.AbstractTreeViewer#getChildren(org.eclipse.swt.widgets.Widget, java.lang.Object[]) 	 */ 	public Item[] getChildren(Widget widget, Object[] elementChildren) { 		Item[] items = super.getChildren(widget,elementChildren); 		if(elementChildren.length == 0 || items.length / elementChildren.length > 5){//Will there be a lot of disposal? 			getTree().removeAll(); 			unmapAllElements(); 			items = getChildren(widget); 		} 		return items; 	} 2) Select push down from the refactor menu in the outline view 3) Click OK on the dialog !ENTRY org.eclipse.ltk.ui.refactoring 4 10000 2007-11-15 08:48:49.894 !MESSAGE Internal Error !STACK 0 java.lang.reflect.InvocationTargetException 	at org.eclipse.jface.operation.ModalContext.run(ModalContext.java:350) 	at org.eclipse.ltk.internal.ui.refactoring.RefactoringWizardDialog2.run(RefactoringWizardDialog2.java:317) 	at org.eclipse.ltk.ui.refactoring.RefactoringWizard.createChange(RefactoringWizard.java:580) 	at org.eclipse.ltk.ui.refactoring.RefactoringWizard.computeUserInputSuccessorPage(RefactoringWizard.java:423) 	at org.eclipse.ltk.ui.refactoring.UserInputWizardPage.computeSuccessorPage(UserInputWizardPage.java:75) 	at org.eclipse.ltk.ui.refactoring.UserInputWizardPage.getNextPage(UserInputWizardPage.java:115) 	at org.eclipse.ltk.internal.ui.refactoring.RefactoringWizardDialog2.nextOrPreviewPressed(RefactoringWizardDialog2.java:488) 	at org.eclipse.ltk.internal.ui.refactoring.RefactoringWizardDialog2.access$0(RefactoringWizardDialog2.java:485) 	at org.eclipse.ltk.internal.ui.refactoring.RefactoringWizardDialog2$1.widgetSelected(RefactoringWizardDialog2.java:678) 	at org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:227) 	at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:66) 	at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:947) 	at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:3744) 	at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3355) 	at org.eclipse.jface.window.Window.runEventLoop(Window.java:825) 	at org.eclipse.jface.window.Window.open(Window.java:801) 	at org.eclipse.ltk.ui.refactoring.RefactoringWizardOpenOperation$1.run(RefactoringWizardOpenOperation.java:142) 	at org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:67) 	at org.eclipse.ltk.ui.refactoring.RefactoringWizardOpenOperation.run(RefactoringWizardOpenOperation.java:154) 	at org.eclipse.jdt.internal.ui.refactoring.actions.RefactoringStarter.activate(RefactoringStarter.java:37) 	at org.eclipse.jdt.internal.corext.refactoring.RefactoringExecutionStarter.startPushDownRefactoring(RefactoringExecutionStarter.java:421) 	at org.eclipse.jdt.ui.actions.PushDownAction.run(PushDownAction.java:121) 	at org.eclipse.jdt.ui.actions.SelectionDispatchAction.dispatchRun(SelectionDispatchAction.java:268) 	at org.eclipse.jdt.ui.actions.SelectionDispatchAction.run(SelectionDispatchAction.java:244) 	at org.eclipse.jface.action.Action.runWithEvent(Action.java:498) 	at org.eclipse.jface.action.ActionContributionItem.handleWidgetSelection(ActionContributionItem.java:582) 	at org.eclipse.jface.action.ActionContributionItem.access$2(ActionContributionItem.java:499) 	at org.eclipse.jface.action.ActionContributionItem$5.handleEvent(ActionContributionItem.java:410) 	at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:66) 	at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:947) 	at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:3744) 	at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3355) 	at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2395) 	at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2359) 	at org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2225) 	at org.eclipse.ui.internal.Workbench$4.run(Workbench.java:468) 	at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:288) 	at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:463) 	at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149) 	at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:106) 	at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:193) 	at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:106) 	at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:76) 	at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:362) 	at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:175) 	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) 	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) 	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) 	at java.lang.reflect.Method.invoke(Method.java:597) 	at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:515) 	at org.eclipse.equinox.launcher.Main.basicRun(Main.java:455) 	at org.eclipse.equinox.launcher.Main.run(Main.java:1193) Caused by: org.eclipse.core.runtime.AssertionFailedException: null argument: 	at org.eclipse.core.runtime.Assert.isNotNull(Assert.java:84) 	at org.eclipse.core.runtime.Assert.isNotNull(Assert.java:72) 	at org.eclipse.jdt.internal.corext.refactoring.structure.PushDownRefactoringProcessor.getCompilationUnitRewrite(PushDownRefactoringProcessor.java:272) 	at org.eclipse.jdt.internal.corext.refactoring.structure.PushDownRefactoringProcessor.createChangeManager(PushDownRefactoringProcessor.java:722) 	at org.eclipse.jdt.internal.corext.refactoring.structure.PushDownRefactoringProcessor.checkFinalConditions(PushDownRefactoringProcessor.java:456) 	at org.eclipse.ltk.core.refactoring.participants.ProcessorBasedRefactoring.checkFinalConditions(ProcessorBasedRefactoring.java:174) 	at org.eclipse.ltk.core.refactoring.CheckConditionsOperation.run(CheckConditionsOperation.java:83) 	at org.eclipse.ltk.core.refactoring.CreateChangeOperation.run(CreateChangeOperation.java:119) 	at org.eclipse.core.internal.resources.Workspace.run(Workspace.java:1798) 	at org.eclipse.ltk.internal.ui.refactoring.WorkbenchRunnableAdapter.run(WorkbenchRunnableAdapter.java:87) 	at org.eclipse.jface.operation.ModalContext$ModalContextThread.run(ModalContext.java:113) Root exception: org.eclipse.core.runtime.AssertionFailedException: null argument: 	at org.eclipse.core.runtime.Assert.isNotNull(Assert.java:84) 	at org.eclipse.core.runtime.Assert.isNotNull(Assert.java:72) 	at org.eclipse.jdt.internal.corext.refactoring.structure.PushDownRefactoringProcessor.getCompilationUnitRewrite(PushDownRefactoringProcessor.java:272) 	at org.eclipse.jdt.internal.corext.refactoring.structure.PushDownRefactoringProcessor.createChangeManager(PushDownRefactoringProcessor.java:722) 	at org.eclipse.jdt.internal.corext.refactoring.structure.PushDownRefactoringProcessor.checkFinalConditions(PushDownRefactoringProcessor.java:456) 	at org.eclipse.ltk.core.refactoring.participants.ProcessorBasedRefactoring.checkFinalConditions(ProcessorBasedRefactoring.java:174) 	at org.eclipse.ltk.core.refactoring.CheckConditionsOperation.run(CheckConditionsOperation.java:83) 	at org.eclipse.ltk.core.refactoring.CreateChangeOperation.run(CreateChangeOperation.java:119) 	at org.eclipse.core.internal.resources.Workspace.run(Workspace.java:1798) 	at org.eclipse.ltk.internal.ui.refactoring.WorkbenchRunnableAdapter.run(WorkbenchRunnableAdapter.java:87) 	at org.eclipse.jface.operation.ModalContext$ModalContextThread.run(ModalContext.java:113)