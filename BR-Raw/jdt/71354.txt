[painting] IAE in StyledText.getBidiSegments upon revert

Copied from bug 71110, comment 6. R3.0 Happened while trying to reproduce bug 71110. I was invoking Find/Replace quickly, also undo, and "revert file" so that I could start fresh to try to reproduce the original bug. java.lang.IllegalArgumentException: Argument not valid at org.eclipse.swt.SWT.error(SWT.java:2677) at org.eclipse.swt.SWT.error(SWT.java:2616) at org.eclipse.swt.SWT.error(SWT.java:2587) at org.eclipse.swt.custom.StyledText.getBidiSegments(StyledText.java:4140) at org.eclipse.swt.custom.DisplayRenderer.getBidiSegments (DisplayRenderer.java:128) at org.eclipse.swt.custom.StyledTextRenderer.getTextLayout (StyledTextRenderer.java:415) at org.eclipse.swt.custom.StyledText$ContentWidthCache.contentWidth (StyledText.java:1257) at org.eclipse.swt.custom.StyledText$ContentWidthCache.calculate (StyledText.java:1221) at org.eclipse.swt.custom.StyledText.redraw(StyledText.java:5849) at org.eclipse.swt.custom.StyledText.handleResize(StyledText.java:5092) at org.eclipse.swt.custom.StyledText$7.handleEvent(StyledText.java:4753) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:82) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:796) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:820) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:801) at org.eclipse.swt.widgets.Control.WM_SIZE(Control.java:4171) at org.eclipse.swt.widgets.Scrollable.WM_SIZE(Scrollable.java:312) at org.eclipse.swt.widgets.Composite.WM_SIZE(Composite.java:875) at org.eclipse.swt.widgets.Control.windowProc(Control.java:3037) at org.eclipse.swt.widgets.Display.windowProc(Display.java:3338) at org.eclipse.swt.internal.win32.OS.CallWindowProcW(Native Method) at org.eclipse.swt.internal.win32.OS.CallWindowProc(OS.java:1391) at org.eclipse.swt.internal.BidiUtil.windowProc(BidiUtil.java:647) at org.eclipse.swt.internal.win32.OS.DefWindowProcW(Native Method) at org.eclipse.swt.internal.win32.OS.DefWindowProc(OS.java:1462) at org.eclipse.swt.widgets.Scrollable.callWindowProc(Scrollable.java:77) at org.eclipse.swt.widgets.Control.windowProc(Control.java:3050) at org.eclipse.swt.widgets.Display.windowProc(Display.java:3338) at org.eclipse.swt.internal.win32.OS.CallWindowProcW(Native Method) at org.eclipse.swt.internal.win32.OS.CallWindowProc(OS.java:1391) at org.eclipse.swt.internal.BidiUtil.windowProc(BidiUtil.java:647) at org.eclipse.swt.internal.win32.OS.EndDeferWindowPos(Native Method) at org.eclipse.swt.widgets.Composite.resizeChildren(Composite.java:432) at org.eclipse.swt.widgets.Composite.resizeChildren(Composite.java:398) at org.eclipse.swt.widgets.Composite.setResizeChildren(Composite.java:499) at org.eclipse.swt.widgets.Composite.layout(Composite.java:349) at org.eclipse.jface.text.source.CompositeRuler.layoutTextViewer (CompositeRuler.java:606) at org.eclipse.jface.text.source.CompositeRuler.addDecorator (CompositeRuler.java:560) at org.eclipse.jface.text.source.projection.ProjectionViewer.addVerticalRulerColumn (ProjectionViewer.java:1187) at org.eclipse.jface.text.source.projection.ProjectionSupport.doEnableProjection (ProjectionSupport.java:253) at org.eclipse.jface.text.source.projection.ProjectionSupport$ProjectionListener.pr ojectionEnabled(ProjectionSupport.java:141) at org.eclipse.jface.text.source.projection.ProjectionViewer.fireProjectionEnabled (ProjectionViewer.java:473) at org.eclipse.jface.text.source.projection.ProjectionViewer.enableProjection (ProjectionViewer.java:521) at org.eclipse.jdt.internal.ui.javaeditor.JavaEditor.performRevert (JavaEditor.java:4327) at org.eclipse.ui.texteditor.AbstractTextEditor.doRevertToSaved (AbstractTextEditor.java:3646) at org.eclipse.ui.texteditor.StatusTextEditor.doRevertToSaved (StatusTextEditor.java:183) at org.eclipse.ui.texteditor.RevertToSavedAction.run (RevertToSavedAction.java:47) at org.eclipse.jface.action.Action.runWithEvent(Action.java:881) at org.eclipse.jface.action.ActionContributionItem.handleWidgetSelection (ActionContributionItem.java:915) at org.eclipse.jface.action.ActionContributionItem.access$2 (ActionContributionItem.java:866) at org.eclipse.jface.action.ActionContributionItem$7.handleEvent (ActionContributionItem.java:785) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:82) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:796) at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:2772) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2431) at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:1377) at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:1348) at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:254) at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:141) at org.eclipse.ui.internal.ide.IDEApplication.run(IDEApplication.java:96) at org.eclipse.core.internal.runtime.PlatformActivator$1.run (PlatformActivator.java:335) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:273) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:129) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) at sun.reflect.DelegatingMethodAccessorImpl.invoke (DelegatingMethodAccessorImpl.java:25) at java.lang.reflect.Method.invoke(Method.java:324) at org.eclipse.core.launcher.Main.basicRun(Main.java:183) at org.eclipse.core.launcher.Main.run(Main.java:644) at org.eclipse.core.launcher.Main.main(Main.java:628)