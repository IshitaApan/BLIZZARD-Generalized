Unable to open Excel report on a system with Arabic locales

Created attachment 119886 Sample report to recreate Excel export bug Steps To Reproduce: 1. Set up Arabic locales (use Arabic Windows, set locale using Locale.setLocale(new Locale("ar")), or set it in the Control Panel). 2. Generate XLS report from sample file (attached to this bug) 3. Open XLS file using Excel 4. You should see error that Excel is unable to open file More information: Excel stores date/time in fixed format - yyyy-MM-dd'T'HH:mm:ss. It is locale independent. Then a style is applied to date/time cell - this style determines how date is displayed. In case of Arabic system locales this internal date format is encoded in UTF-8. Excel cannot read it and shows an error. I found that problem is in a ExcelUtil class. There is a method: public static String formatDate( Object date ) 	{ 		SimpleDateFormat dateFormat = new SimpleDateFormat( 				"yyyy-MM-dd'T'HH:mm:ss"); 		return dateFormat.format( (Date) date ); 	} that formats date in cell. It should always format date in English locale (since date is in internal fixed format): public static String formatDate( Object date ) 	{ 		SimpleDateFormat dateFormat = new SimpleDateFormat( 				"yyyy-MM-dd'T'HH:mm:ss",Locale.ENGLISH ); 		return dateFormat.format( (Date) date ); 	} Here is a sample Java code that demonstrates how ICU formats date when locale is Arabic: public class DateFormatTest { 	public static void main(String[] args) { 		java.util.Locale.setDefault(new Locale("ar")); 		SimpleDateFormat dateFormat = new SimpleDateFormat( 				"yyyy-MM-dd'T'HH:mm:ss"); 		System.out.println(dateFormat.format(new Date() )); 	} } This bug exists in 2.2.1 and 2.3.1 versions (and I assume that also in the versions between them).