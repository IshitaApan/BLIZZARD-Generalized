Total.Rank result incorrect.

The Total.rank() aggregation function should follow Excel convention, that is, the identical values should only hold one place in rank. The following table give details: Value | Rank 20 | 3 10 | 4 30 | 2 30 | 2 40 | 1