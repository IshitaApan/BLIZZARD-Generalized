XLS Emitter: Report with hidden rows throws NPE

Created attachment 74877 Report with hidden rows 1. Create report with hidden rows (see attached example hideRows.rptdesign). 2. Run report to create rptdocument. 3. Render rptdocument with format "xls". Expected: output in xls format Actual: NPE is thrown Caused by: java.lang.NullPointerException 	at java.lang.String.indexOf(Unknown Source) 	at java.lang.String.indexOf(Unknown Source) 	at org.eclipse.birt.report.engine.layout.LayoutUtil.isRowHidden(LayoutUtil.java:36) 	at org.eclipse.birt.report.engine.layout.html.HTMLTableLayoutNoNestEmitter.startRow(HTMLTableLayoutNoNestEmitter.java:230) 	at org.eclipse.birt.report.engine.emitter.ContentEmitterUtil$StartContentVisitor.visitRow(ContentEmitterUtil.java:96) 	at org.eclipse.birt.report.engine.content.impl.RowContent.accept(RowContent.java:59) 	at org.eclipse.birt.report.engine.emitter.ContentEmitterUtil$StartContentVisitor.visit(ContentEmitterUtil.java:55) 	at org.eclipse.birt.report.engine.emitter.ContentEmitterUtil.startContent(ContentEmitterUtil.java:42) 	at org.eclipse.birt.report.engine.layout.html.HTMLAbstractLM.startContent(HTMLAbstractLM.java:113) 	at org.eclipse.birt.report.engine.layout.html.HTMLAbstractLM.startContent(HTMLAbstractLM.java:109) 	at org.eclipse.birt.report.engine.layout.html.HTMLAbstractLM.startContent(HTMLAbstractLM.java:109) 	at org.eclipse.birt.report.engine.layout.html.HTMLLeafItemLM.start(HTMLLeafItemLM.java:61) 	at org.eclipse.birt.report.engine.layout.html.HTMLAbstractLM.layout(HTMLAbstractLM.java:170) 	at org.eclipse.birt.report.engine.layout.html.HTMLLeafItemLM.layout(HTMLLeafItemLM.java:31) 	at org.eclipse.birt.report.engine.layout.html.HTMLBlockStackingLM.layoutChildren(HTMLBlockStackingLM.java:68) 	at org.eclipse.birt.report.engine.layout.html.HTMLAbstractLM.layout(HTMLAbstractLM.java:171) 	at org.eclipse.birt.report.engine.layout.html.HTMLInlineStackingLM.resumeLayout(HTMLInlineStackingLM.java:94) 	at org.eclipse.birt.report.engine.layout.html.HTMLInlineStackingLM.layoutChildren(HTMLInlineStackingLM.java:138) 	at org.eclipse.birt.report.engine.layout.html.HTMLRowLM.layoutChildren(HTMLRowLM.java:41) 	at org.eclipse.birt.report.engine.layout.html.HTMLAbstractLM.layout(HTMLAbstractLM.java:171) 	at org.eclipse.birt.report.engine.layout.html.HTMLRowLM.layout(HTMLRowLM.java:31) 	at org.eclipse.birt.report.engine.layout.html.HTMLBlockStackingLM.layoutChildren(HTMLBlockStackingLM.java:68) 	at org.eclipse.birt.report.engine.layout.html.HTMLTableBandLM.layoutChildren(HTMLTableBandLM.java:66) 	at org.eclipse.birt.report.engine.layout.html.HTMLAbstractLM.layout(HTMLAbstractLM.java:171) 	at org.eclipse.birt.report.engine.layout.html.HTMLBlockStackingLM.layoutChildren(HTMLBlockStackingLM.java:68) 	at org.eclipse.birt.report.engine.layout.html.HTMLTableLM.layoutChildren(HTMLTableLM.java:81) 	at org.eclipse.birt.report.engine.layout.html.HTMLAbstractLM.layout(HTMLAbstractLM.java:171) 	at org.eclipse.birt.report.engine.layout.html.HTMLPageLM.layoutChildren(HTMLPageLM.java:142) 	at org.eclipse.birt.report.engine.layout.html.HTMLPageLM.layout(HTMLPageLM.java:84) 	at org.eclipse.birt.report.engine.layout.html.HTMLReportLayoutEngine.layout(HTMLReportLayoutEngine.java:90) 	at org.eclipse.birt.report.engine.api.impl.RenderTask$PageRangeRender.render(RenderTask.java:532) 	at org.eclipse.birt.report.engine.api.impl.RenderTask.render(RenderTask.java:254) 	at org.eclipse.birt.report.service.ReportEngineService.renderReport(Unknown Source) 	... 25 more ExcelEmitter extends ContentEmitterAdapter, 	 ContentEmitterAdapter: public String getOutputFormat( ) 	{ 		return null; 	} ExcelEmitter should override getOutputFormat(). Why are there two excel emitter packages in the repository: org.eclipse.birt.report.engine.emitter.Prototype_excel and org.eclipse.birt.report.engine.emitter.prototype.excel ?