Issue when using include directive inside tag files that are inside jar files

Created attachment 22760 patch for ParserController class When we use the include directive inside a tag file like : <%@ tag body-content="empty" description="Renders a date control to query the creation date of a content object." %> <%@include file="/META-INF/tags/search/declaration.tagf" %> And that this tag file is inside a jar file, jasper has an issue dealing the dependencies by losing the fact that the included file is inside a jar file. static { _jspx_dependants = new java.util.ArrayList(4); _jspx_dependants.add("/META-INF/tags/search/declaration.tagf"); _jspx_dependants.add("/META-INF/tags/search/date.tagf"); _jspx_dependants.add("jar:file:/home/rincevent/tools/apache-tomcat-6.0.18/webapps/jahia/WEB-INF/lib/jahia-taglib-6.0-SNAPSHOT.jar!/META-INF/search.tld"); _jspx_dependants.add("jar:file:/home/rincevent/tools/apache-tomcat-6.0.18/webapps/jahia/WEB-INF/lib/jahia-taglib-6.0-SNAPSHOT.jar!/META-INF/tags/search/resultsPageUrl.tag"); } The other dependencies are handled correctly thanks to patch https://issues.apache.org/bugzilla/show_bug.cgi?id=43741 . I propose a patch to ParserController so that when we detect that we are inside a jarFile we prepend the jarFileUrl to absFileName. The patch has been made on the trunk source code of tomcat.